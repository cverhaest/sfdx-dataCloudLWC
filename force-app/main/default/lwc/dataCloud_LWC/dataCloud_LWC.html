<template>
    <div class="slds-card__body slds-card_boundary">
    <lightning-card variant={variant} title={finalTitle} icon-name={iconName}>
        <lightning-button-icon icon-name="utility:refresh" variant="border-filled" onclick={handleRefresh} alternative-text="Refresh" slot="actions"></lightning-button-icon>
        <div class="slds-card__body">
            <template lwc:if={bDisplayTable}>
                <table class="slds-table slds-table_fixed-layout slds-table_bordered slds-no-row-hover slds-table_cell-buffer" key={oData}>
                    <template for:each={lData} for:item="oData" for:index="index">
                        <template lwc:if={index}>
                        </template>
                        <template lwc:else>    
                            <thead key={oData}>
                                <tr class="slds-text-title_caps">
                                    <template for:each={oData} for:item="oRow">
                                        <th scope="col" key={oRow.name}><div class="slds-truncate" title={oRow.name}>{oRow.name}</div></th>
                                    </template>
                                </tr>
                            </thead>
                        </template>
                        <tbody key={oData}>
                            <tr class="slds-hint-parent">
                                <template for:each={oData} for:item="oRow">
                                    <td key={oRow.name}><div class="slds-truncate">{oRow.value}</div></td>
                                </template>
                            </tr>
                            <!--
                            <tr class="slds-hint-parent">
                                <th scope="row"><div class="slds-truncate">ssot__Salutation__c</div></th>
                                <td><div class="slds-truncate">{ssot__Salutation__c}</div></td>
                            </tr>
                            <tr class="slds-hint-parent">
                                <th scope="row"><div class="slds-truncate">ssot__FirstName__c</div></th>
                                <td><div class="slds-truncate">{ssot__FirstName__c}</div></td>
                            </tr>
                            <tr class="slds-hint-parent">
                                <th scope="row"><div class="slds-truncate">ssot__LastName__c</div></th>
                                <td><div class="slds-truncate">{ssot__LastName__c}</div></td>
                            </tr>
                            <tr class="slds-hint-parent">
                                <th scope="row"><div class="slds-truncate">ssot__Id__c</div></th>
                                <td><div class="slds-truncate">{ssot__Id__c}</div></td>
                            </tr>
                            <tr class="slds-hint-parent">
                                <th scope="row"><div class="slds-truncate">MDMId__c</div></th>
                                <td><div class="slds-truncate">{MDMId__c}</div></td>
                            </tr>
                            <tr class="slds-hint-parent">
                                <th scope="row"><div class="slds-truncate">ssot__BirthDate__c</div></th>
                                <td><div class="slds-truncate">{ssot__BirthDate__c}</div></td>
                            </tr>
                            -->
                        </tbody>
                    </template>    
                </table>
            </template>
            <template lwc:else>
                <!-- Using iterator to add <br> to separate each record except after the last record-->
                <template iterator:odata={lData}>
                    <table class="slds-table slds-table_fixed-layout slds-table_bordered slds-no-row-hover slds-table_cell-buffer" key={oData}>
                        <thead key={odata.value}>
                            <tr class="slds-text-title_caps">
                                <th scope="col"><div class="slds-truncate" title="Field Name">Field Name</div></th>
                                <th scope="col"><div class="slds-truncate" title="Value">Value</div></th>
                            </tr>
                        </thead>
                        <tbody key={odata.value}>
                            <template for:each={odata.value} for:item="oRow" >
                                <tr class="slds-hint-parent" key={oRow.name}>
                                    <th scope="row"><div class="slds-truncate">{oRow.name}</div></th>
                                    <td><div class="slds-truncate">{oRow.value}</div></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                    <template lwc:if={odata.last}></template>
                    <template lwc:else>
                        <br key={odata.value}/>
                    </template>
                </template>
            </template>
        </div>
    </lightning-card>  
    </div>

    <!-- DEBUG
    <p>{ssot__PersonName__c}</p>
    -->

    <!-- DEBUG
    <template for:each={lData} for:item="oData" >
        <template for:each={oData} for:item="oRow" >
            <p key={oRow.name}>{oRow.name} - {oRow.value}</p>
        </template>
    </template> -->
</template>